<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.reserve.app.mapper.AdminMapper">

	<select id="getUserList" parameterType="map" resultType="map">
		SELECT id, name, phone_number, user_role, remark, to_char(created_dt,'YYYY-MM-DD') as created_dt, to_char(modified_dt,'YYYY-MM-DD') as modified_dt, user_status
		FROM tb_user
		<where>
			<if test='userIdOrName != null and userIdOrName != ""'>
				and (
					upper(id) like '%' || upper(#{userIdOrName}) || '%' 
					or upper(name) like '%' || upper(#{userIdOrName}) || '%'
				)
			</if>
			<if test='name!=null and name!=""'>and upper(name) like '%'||upper(#{name})||'%'</if>
			<if test='phoneNumber!=null and phoneNumber!=""'>and phone_number like '%'||upper(#{phoneNumber})||'%'</if>
			<if test="startDate != null and startDate != '' and endDate != null and endDate != ''">
				and created_dt BETWEEN to_timestamp(#{startDate}, 'YYYY-MM-DD') AND to_timestamp(#{endDate}, 'YYYY-MM-DD') + INTERVAL '1 day' - INTERVAL '1 second'
			</if>
		</where>
		order by created_dt desc
	</select>
</mapper>